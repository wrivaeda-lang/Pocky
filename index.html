<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü•¢ Pocky Tracker</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @keyframes pulse-glow {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(168, 85, 247, 0.6);
            }
            50% { 
                box-shadow: 0 0 30px rgba(239, 68, 68, 0.7);
            }
        }
        .animate-pulse-glow {
            animation: pulse-glow 2s ease-in-out infinite;
        }
        
        /* iOS PWA support */
        @media (display-mode: standalone) {
            body {
                padding-top: env(safe-area-inset-top);
                padding-bottom: env(safe-area-inset-bottom);
            }
        }
    </style>
    
    <!-- PWA Meta Tags for iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Pocky Tracker">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ü•¢</text></svg>">
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide React Icons (inline SVG components)
        const Check = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
            </svg>
        );

        const Plus = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
            </svg>
        );

        const Search = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <circle cx="11" cy="11" r="8" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="m21 21-4.35-4.35" />
            </svg>
        );

        const Star = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
            </svg>
        );

        const INITIAL_FLAVORS = [
            // Classic/Permanent (Verified from document)
            { id: 1, name: 'Original Chocolate', category: 'Classic', region: 'Worldwide', year: 1966, country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 2, name: 'Strawberry', category: 'Classic', region: 'Worldwide', year: 1977, country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 3, name: 'Almond Crush', category: 'Classic', region: 'Worldwide', year: 1971, country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 4, name: 'Chocolate Banana', category: 'Classic', region: 'Worldwide', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 5, name: 'Cookies & Cream', category: 'Classic', region: 'Worldwide', country: 'üá∫üá∏', premium: false, limited: false, discontinued: false },
            { id: 6, name: 'Matcha Green Tea', category: 'Classic', region: 'Worldwide', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 7, name: 'Double Rich Matcha', category: 'Seasonal', region: 'Japan', year: 2025, country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 8, name: "Men's Pocky (Dark Chocolate)", category: 'Special', region: 'Japan', year: 1980, country: 'üáØüáµ', premium: false, limited: false, discontinued: true },
            { id: 9, name: 'Milk', category: 'Classic', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 10, name: 'Mousse', category: 'Classic', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 11, name: 'Cacao 60%', category: 'Classic', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 12, name: 'Crunchy Strawberry', category: 'Classic', region: 'Worldwide', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 13, name: 'Ultra Slim', category: 'Special', region: 'Worldwide', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            
            // Seasonal (Verified)
            { id: 14, name: 'Sakura (Cherry Blossom)', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 15, name: 'Cherry Blossom Matcha', category: 'Seasonal', region: 'Japan', year: 2025, country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 16, name: 'Almond Crush (Winter)', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 17, name: 'Honey (Spring)', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            { id: 18, name: 'Kiwifruit (Summer)', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            { id: 19, name: 'Triple Almond (Autumn)', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 20, name: 'Winter Melty', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 21, name: 'Butter Caramel', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 22, name: 'Orange Peel', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 23, name: 'Peppermint', category: 'Seasonal', region: 'USA', year: 2020, country: 'üá∫üá∏', premium: false, limited: true, discontinued: true },
            { id: 24, name: 'Mint', category: 'Seasonal', region: 'USA', year: 2025, country: 'üá∫üá∏', premium: false, limited: true, discontinued: false },
            { id: 25, name: 'Coconut (Summer)', category: 'Seasonal', region: 'USA', year: 2025, country: 'üá∫üá∏', premium: false, limited: true, discontinued: false },
            { id: 26, name: 'Salted Vanilla', category: 'Seasonal', region: 'USA', year: 2025, country: 'üá∫üá∏', premium: false, limited: true, discontinued: false },
            
            // Regional Japan (Verified with LIMITED tags)
            { id: 27, name: 'Yubari Melon (Hokkaido)', category: 'Regional', region: 'Japan - Hokkaido', year: 1994, country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 28, name: 'Shinshu Kyoho Grape (Nagano)', category: 'Regional', region: 'Japan - Nagano', year: 2016, country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 29, name: 'Uji Matcha (Kyoto)', category: 'Regional', region: 'Japan - Kyoto', country: 'üáØüáµ', premium: true, limited: true, discontinued: false },
            { id: 30, name: 'Tokyo Amazake', category: 'Regional', region: 'Japan - Tokyo', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 31, name: 'Iyokan Orange (Ehime)', category: 'Regional', region: 'Japan - Ehime', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 32, name: 'Amaou Strawberry (Fukuoka)', category: 'Regional', region: 'Japan - Fukuoka', year: 2016, country: 'üáØüáµ', premium: true, limited: true, discontinued: false },
            { id: 33, name: 'Giant Mikan (Kyushu)', category: 'Regional', region: 'Japan - Kyushu', year: 1990, country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            { id: 34, name: 'Powdered Tea Azuki Bean (Kyoto)', category: 'Regional', region: 'Japan - Kyoto', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 35, name: 'Kobe Wine', category: 'Regional', region: 'Japan - Kobe', country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            { id: 36, name: 'Five-Fusion Berry (Goka)', category: 'Regional', region: 'Japan - Goka', year: 1994, country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            { id: 37, name: 'Gorojima Kintoki (Ishikawa)', category: 'Regional', region: 'Japan - Ishikawa', year: 2016, country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 38, name: 'Sato Nishiki Cherry (Yamagata)', category: 'Regional', region: 'Japan - Yamagata', year: 2016, country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            
            // Fruit Flavors (Verified)
            { id: 39, name: 'Lychee', category: 'Fruit', region: 'Asia', country: 'üá®üá≥', premium: false, limited: true, discontinued: true },
            { id: 40, name: 'Melon', category: 'Fruit', region: 'Various', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 41, name: 'Berry', category: 'Fruit', region: 'Various', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 42, name: 'Pineapple', category: 'Fruit', region: 'Various', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 43, name: 'Cherry', category: 'Fruit', region: 'Various', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 44, name: 'Orange', category: 'Fruit', region: 'Various', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 45, name: 'Mikan (Mandarin)', category: 'Fruit', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 46, name: 'Blueberry', category: 'Fruit', region: 'Various', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 47, name: 'Apple Yogurt', category: 'Fruit', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 48, name: 'Mixed Berry', category: 'Fruit', region: 'Various', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 49, name: 'Kiwi', category: 'Fruit', region: 'Various', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 50, name: 'Grape', category: 'Fruit', region: 'Various', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 51, name: 'Mango (Summer)', category: 'Fruit', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            
            // Premium (Verified - these are LUXURY items)
            { id: 52, name: 'Premium Milk Chocolate', category: 'Premium', region: 'Japan', country: 'üáØüáµ', premium: true, limited: false, discontinued: false },
            { id: 53, name: 'Zeitaku Strawberry', category: 'Premium', region: 'USA', year: 2025, country: 'üá∫üá∏', premium: true, limited: true, discontinued: false },
            { id: 54, name: 'Premium Strawberry', category: 'Premium', region: 'Japan', country: 'üáØüáµ', premium: true, limited: true, discontinued: false },
            
            // Special & Premium (Verified)
            { id: 55, name: 'Adult Amber (Whisky-infused)', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: true, limited: true, discontinued: false },
            { id: 56, name: 'Salted Vanilla', category: 'Seasonal', region: 'USA', year: 2025, country: 'üá∫üá∏', premium: false, limited: true, discontinued: false },
            { id: 57, name: 'Double Berry (Blueberry & Raspberry)', category: 'Special', region: 'Hong Kong', country: 'üá≠üá∞', premium: false, limited: false, discontinued: false },
            { id: 58, name: 'Tasty (Fermented Butter)', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: true, limited: false, discontinued: false },
            { id: 59, name: 'Pocky G (Hard & Rich)', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 60, name: 'Decorer Pocky (Decorative)', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 61, name: 'Authentic Cacao (60% Bitter)', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 62, name: 'Giant Pocky Chocolate', category: 'Special', region: 'Japan', year: 1989, country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            
            // Other Flavors (Verified)
            { id: 63, name: 'Coffee', category: 'Other', region: 'Various', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 64, name: 'Caramel', category: 'Other', region: 'Asia', country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            { id: 65, name: 'Marble Royal Milk Tea', category: 'Other', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 66, name: 'Cream Cheese', category: 'Other', region: 'Various', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 67, name: 'Sweet Potato', category: 'Other', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 68, name: 'Coconut', category: 'Other', region: 'Various', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 69, name: 'Chocolate Coconut', category: 'Other', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 70, name: 'Crush (Crunchy Cracker)', category: 'Other', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 71, name: 'Corn on the Cob', category: 'Other', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 72, name: 'Pumpkin', category: 'Other', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            { id: 73, name: 'Black Sesame (Kurogoma)', category: 'Other', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            { id: 74, name: 'Kinako (Soybean Flour)', category: 'Other', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 75, name: 'Brazilian Pudding', category: 'Other', region: 'Brazil', country: 'üáßüá∑', premium: false, limited: false, discontinued: false },
            { id: 76, name: 'Tomato', category: 'Other', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 77, name: 'Hazelnut', category: 'Other', region: 'Various', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 78, name: 'Honey & Milk', category: 'Other', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 79, name: 'Choco-Mint', category: 'Other', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 80, name: 'Peanut Butter', category: 'Other', region: 'USA', country: 'üá∫üá∏', premium: false, limited: false, discontinued: false },
            { id: 81, name: 'Daim Bar', category: 'Other', region: 'UK', year: 2000, country: 'üá¨üáß', premium: false, limited: false, discontinued: false },
            
            // ========== MIDI POCKY SERIES ==========
            { id: 82, name: 'Midi Chocolate', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 83, name: 'Midi Strawberry', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 84, name: 'Midi Rich Strawberry Latte', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 85, name: 'Midi Matcha', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 86, name: 'Midi Caramel Latte', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 87, name: 'Midi Squeeze Peach', category: 'Fruit', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 88, name: 'Midi Squeeze Rich Grapes', category: 'Fruit', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 89, name: 'Midi Squeeze Mango', category: 'Fruit', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 90, name: 'Midi Premium Almond Milk', category: 'Premium', region: 'Japan', country: 'üáØüáµ', premium: true, limited: true, discontinued: false },
            { id: 91, name: 'Midi Premium Zeitaku Milk Chocolate', category: 'Premium', region: 'Japan', country: 'üáØüáµ', premium: true, limited: false, discontinued: false },
            { id: 92, name: 'Midi Luxury Strawberry', category: 'Premium', region: 'Japan', country: 'üáØüáµ', premium: true, limited: false, discontinued: false },
            
            // ========== GIANT POCKY ==========
            { id: 93, name: 'Giant Pocky Strawberry', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 94, name: 'Giant Dream Pocky (Multi-Flavor)', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            
            // ========== ULTRA SLIM POCKY ==========
            { id: 95, name: 'Ultra Slim Chocolate', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 96, name: 'Ultra Slim Milk Cream', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 97, name: 'Ultra Slim Strawberry Cream', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 98, name: 'Slim Less Sugar Strawberry', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 99, name: 'Slim Less Sugar Milk Cream', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 100, name: 'Slim Less Sugar Matcha', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            
            // ========== MOUSSE POCKY ==========
            { id: 101, name: 'Mousse Chocolate', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 102, name: 'Mousse Matcha', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 103, name: 'Mousse Mango', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 104, name: 'Mousse Milk', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 105, name: 'Mousse Sakura', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 106, name: 'Mousse Taro', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            
            // ========== CRUNCHY/CRUSH POCKY ==========
            { id: 107, name: 'Almond Crush Chocolate Quinoa', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 108, name: 'Almond Crush Milk Quinoa', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 109, name: 'Hazelnut Crush', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 110, name: 'Sakura Almond Pocky', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 111, name: 'Matcha Green Tea Crush', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 112, name: 'Azuki Red Beans Crush', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 113, name: 'Berry Chocolat', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            
            // ========== SEASONAL (Additional) ==========
            { id: 114, name: 'Kuchidoke Chocolate (Winter)', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 115, name: 'Glitter Golden Butter (Winter)', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 116, name: 'Sakura Matcha (Spring)', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 117, name: 'Summer Paradise', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 118, name: 'Chocolate Mint (Summer)', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 119, name: 'Salty Vanilla (Summer)', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 120, name: 'Watermelon (Summer)', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 121, name: 'Trinity Almond (Autumn)', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 122, name: 'Trinity Orange Peel (Autumn)', category: 'Seasonal', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            
            // ========== LIMITED EDITION ==========
            { id: 123, name: 'Relax Pocky Cheesecake', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: true, limited: true, discontinued: false },
            { id: 124, name: 'Relax Pocky Matcha Ice Cream', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: true, limited: true, discontinued: false },
            { id: 125, name: 'Black Honey Kinako', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: true, limited: true, discontinued: false },
            { id: 126, name: 'White Peach & Strawberry', category: 'Fruit', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 127, name: 'Vanilla-Scented White', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 128, name: 'Yuzu', category: 'Fruit', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 129, name: 'Couple De Fruits Raspberry & Pistachio', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: true, limited: true, discontinued: false },
            { id: 130, name: 'Couple De Fruits Lemon & Peach', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: true, limited: true, discontinued: false },
            { id: 131, name: 'Bitter Pocky 60% Cacao', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 132, name: 'Wholesome Chocolate Almond', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 133, name: 'Wholesome Blueberry Yogurt', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: false, discontinued: false },
            { id: 134, name: 'Heartful Blueberry', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 135, name: 'Heartful Strawberry', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 136, name: 'Heartful Cherry', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            { id: 137, name: 'Pocky Colorful', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: false },
            
            // ========== COLLABORATION POCKY ==========
            { id: 138, name: 'Snoopy Peanuts Pocky', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            { id: 139, name: 'Hello Kitty Strawberry', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            { id: 140, name: 'Kirin Teagurt (Lemon)', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            { id: 141, name: 'Kirin Banana Bran', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            { id: 142, name: 'Kirin Coffee & Cocoa', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            { id: 143, name: 'Kumamon Milky Cocoa', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: false, limited: true, discontinued: true },
            { id: 144, name: 'Ya Kun Kaya Toast', category: 'Special', region: 'Singapore', country: 'üá∏üá¨', premium: false, limited: true, discontinued: true },
            { id: 145, name: 'Ya Kun Kopi O', category: 'Special', region: 'Singapore', country: 'üá∏üá¨', premium: false, limited: true, discontinued: true },
            
            // ========== LIQUOR POCKY ==========
            { id: 146, name: 'Goddess Ruby (Wine Pairing)', category: 'Special', region: 'Japan', country: 'üáØüáµ', premium: true, limited: true, discontinued: false },
            { id: 147, name: 'Jiangxiaobai (Chinese Spirit)', category: 'Special', region: 'China', country: 'üá®üá≥', premium: false, limited: true, discontinued: true },
        ];

        function PockyTracker() {
            const [flavors, setFlavors] = useState([]);
            const [loading, setLoading] = useState(true);
            const [searchTerm, setSearchTerm] = useState('');
            const [filterCategory, setFilterCategory] = useState('All');
            const [filterStatus, setFilterStatus] = useState('All');
            const [showAddForm, setShowAddForm] = useState(false);
            const [newFlavor, setNewFlavor] = useState({ 
                name: '', 
                category: 'Other', 
                region: 'Custom',
                country: '',
                year: '',
                premium: false,
                limited: false,
                discontinued: false
            });
            const [viewMode, setViewMode] = useState('grid');
            const [darkMode, setDarkMode] = useState(false);
            const [editMode, setEditMode] = useState(false);
            const [expandedNotes, setExpandedNotes] = useState({});
            const [editingFlavorId, setEditingFlavorId] = useState(null);

            useEffect(() => {
                loadData();
            }, []);

            const loadData = () => {
                const CURRENT_VERSION = 3;
                
                try {
                    const stored = localStorage.getItem('pocky-tracker-data');
                    if (stored) {
                        const data = JSON.parse(stored);
                        console.log('Loaded from localStorage:', data.flavors.length, 'flavors');
                        
                        if (!data.version || data.version < CURRENT_VERSION || data.flavors.length !== INITIAL_FLAVORS.length) {
                            console.log('Old version detected, reloading fresh data');
                            initializeDefault();
                            setLoading(false);
                            return;
                        }
                        
                        setFlavors(data.flavors);
                        setLoading(false);
                        return;
                    }
                } catch (error) {
                    console.log('localStorage error:', error);
                }
                
                console.log('Initializing with', INITIAL_FLAVORS.length, 'flavors');
                initializeDefault();
                setLoading(false);
            };

            const initializeDefault = () => {
                const initialData = INITIAL_FLAVORS.map(f => ({
                    ...f,
                    tasted: f.tasted !== undefined ? f.tasted : false,
                    rating: f.rating !== undefined ? f.rating : 0,
                    notes: f.notes || '',
                    dateAdded: f.dateAdded || new Date().toISOString().split('T')[0]
                }));
                setFlavors(initialData);
                saveData(initialData);
            };

            const saveData = (updatedFlavors) => {
                const dataToSave = {
                    version: 2,
                    flavors: updatedFlavors,
                    lastUpdated: new Date().toISOString()
                };
                
                try {
                    localStorage.setItem('pocky-tracker-data', JSON.stringify(dataToSave));
                } catch (e) {
                    console.error('Storage error:', e);
                }
            };

            const exportData = () => {
                const dataStr = JSON.stringify({
                    flavors,
                    exportDate: new Date().toISOString()
                }, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `pocky-tracker-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                URL.revokeObjectURL(url);
            };

            const importData = (event) => {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const imported = JSON.parse(e.target.result);
                        if (imported.flavors && Array.isArray(imported.flavors)) {
                            setFlavors(imported.flavors);
                            saveData(imported.flavors);
                            alert('Data imported successfully!');
                        }
                    } catch (error) {
                        alert('Error importing data. Please check the file format.');
                    }
                };
                reader.readAsText(file);
            };

            const toggleTasted = (id) => {
                const updated = flavors.map(f => 
                    f.id === id ? { ...f, tasted: !f.tasted } : f
                );
                setFlavors(updated);
                saveData(updated);
            };

            const updateRating = (id, rating) => {
                const updated = flavors.map(f => 
                    f.id === id ? { ...f, rating, tier: ratingToTier(rating) } : f
                );
                setFlavors(updated);
                saveData(updated);
            };

            const ratingToTier = (rating) => {
                if (rating === 0) return 'Unrated';
                if (rating >= 4.5) return 'S';
                if (rating >= 4) return 'A';
                if (rating >= 3.5) return 'B';
                if (rating >= 3) return 'C';
                if (rating >= 2) return 'D';
                return 'F';
            };

            const updateNotes = (id, notes) => {
                const updated = flavors.map(f => 
                    f.id === id ? { ...f, notes } : f
                );
                setFlavors(updated);
                saveData(updated);
            };

            const addCustomFlavor = () => {
                if (!newFlavor.name.trim()) return;
                
                const customFlavor = {
                    id: Date.now(),
                    name: newFlavor.name,
                    category: newFlavor.category,
                    region: newFlavor.region,
                    country: newFlavor.country,
                    year: newFlavor.year ? parseInt(newFlavor.year) : undefined,
                    premium: newFlavor.premium,
                    limited: newFlavor.limited,
                    discontinued: newFlavor.discontinued,
                    tasted: false,
                    rating: 0,
                    notes: '',
                    dateAdded: new Date().toISOString().split('T')[0]
                };
                
                const updated = [...flavors, customFlavor];
                setFlavors(updated);
                saveData(updated);
                setNewFlavor({ 
                    name: '', 
                    category: 'Other', 
                    region: 'Custom',
                    country: '',
                    year: '',
                    premium: false,
                    limited: false,
                    discontinued: false
                });
                setShowAddForm(false);
            };

            const toggleNotes = (id) => {
                setExpandedNotes(prev => ({
                    ...prev,
                    [id]: !prev[id]
                }));
            };

            const updateFlavor = (id, updates) => {
                const updated = flavors.map(f => 
                    f.id === id ? { ...f, ...updates } : f
                );
                setFlavors(updated);
                saveData(updated);
            };

            const deleteFlavor = (id) => {
                if (!window.confirm('Delete this flavor permanently?')) return;
                
                const updated = flavors.filter(f => f.id !== id);
                setFlavors(updated);
                saveData(updated);
            };

            const filteredFlavors = flavors.filter(f => {
                const matchesSearch = f.name.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesCategory = filterCategory === 'All' || f.category === filterCategory;
                const matchesStatus = filterStatus === 'All' || 
                    (filterStatus === 'Tasted' && f.tasted) || 
                    (filterStatus === 'Untasted' && !f.tasted) ||
                    (filterStatus === 'Premium' && f.premium) ||
                    (filterStatus === 'Limited' && f.limited) ||
                    (filterStatus === 'Discontinued' && f.discontinued);
                return matchesSearch && matchesCategory && matchesStatus;
            }).sort((a, b) => {
                const getPriority = (f) => {
                    if (f.discontinued) return 6;
                    if (f.category === 'Other') return 5;
                    if (f.limited) return 4;
                    if (f.category === 'Special') return 3;
                    if (['Seasonal', 'Regional', 'Fruit'].includes(f.category)) return 2;
                    if (f.category === 'Classic') return 1;
                    return 7;
                };
                
                const priorityDiff = getPriority(a) - getPriority(b);
                if (priorityDiff !== 0) return priorityDiff;
                return a.name.localeCompare(b.name);
            });

            const stats = {
                total: flavors.length,
                tasted: flavors.filter(f => f.tasted).length,
                percentage: flavors.length > 0 ? Math.round((flavors.filter(f => f.tasted).length / flavors.length) * 100) : 0
            };

            const categories = ['All', 'Classic', 'Seasonal', 'Regional', 'Fruit', 'Premium', 'Special', 'Other'];
            
            const tierConfig = [
                { name: 'S', color: 'bg-red-400', label: 'S Tier (4.5-5‚òÖ)' },
                { name: 'A', color: 'bg-orange-400', label: 'A Tier (4-4.5‚òÖ)' },
                { name: 'B', color: 'bg-yellow-400', label: 'B Tier (3.5-4‚òÖ)' },
                { name: 'C', color: 'bg-green-400', label: 'C Tier (3-3.5‚òÖ)' },
                { name: 'D', color: 'bg-blue-400', label: 'D Tier (2-3‚òÖ)' },
                { name: 'F', color: 'bg-purple-400', label: 'F Tier (0.5-2‚òÖ)' },
                { name: 'Unrated', color: 'bg-pink-300', label: 'Unrated (0‚òÖ)' }
            ];

            const getTierFlavors = (tierName) => {
                return flavors.filter(f => {
                    const tier = ratingToTier(f.rating);
                    return tier === tierName;
                }).sort((a, b) => {
                    const getPriority = (f) => {
                        if (f.discontinued) return 6;
                        if (f.category === 'Other') return 5;
                        if (f.limited) return 4;
                        if (f.category === 'Special') return 3;
                        if (['Seasonal', 'Regional', 'Fruit'].includes(f.category)) return 2;
                        if (f.category === 'Classic') return 1;
                        return 7;
                    };
                    
                    const priorityDiff = getPriority(a) - getPriority(b);
                    if (priorityDiff !== 0) return priorityDiff;
                    return a.name.localeCompare(b.name);
                });
            };

            if (loading) {
                return (
                    <div className={`min-h-screen flex items-center justify-center ${darkMode ? 'bg-gray-900' : 'bg-gradient-to-br from-purple-50 to-pink-50'}`}>
                        <div className={`text-xl ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>Loading your Pocky collection...</div>
                    </div>
                );
            }

            return (
                <div className={`min-h-screen p-4 md:p-6 transition-colors ${darkMode ? 'bg-gray-900' : 'bg-gradient-to-br from-purple-50 to-pink-50'}`}>
                    <div className="max-w-6xl mx-auto">
                        {/* Header */}
                        <div className={`rounded-xl shadow-lg p-4 md:p-6 mb-6 ${darkMode ? 'bg-gray-800 text-white' : 'bg-white'}`}>
                            <div className="flex justify-between items-start mb-4 flex-wrap gap-2">
                                <div>
                                    <h1 className="text-3xl md:text-4xl font-bold text-red-600 mb-2">ü•¢ Pocky Tracker</h1>
                                    <p className={`text-sm md:text-base ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>Track every Pocky flavor! ({INITIAL_FLAVORS.length} flavors in database)</p>
                                </div>
                                <div className="flex gap-2 flex-wrap">
                                    <button
                                        onClick={() => setDarkMode(!darkMode)}
                                        className="px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm"
                                        title="Toggle dark mode"
                                    >
                                        {darkMode ? '‚òÄÔ∏è' : 'üåô'}
                                    </button>
                                    <button
                                        onClick={() => setEditMode(!editMode)}
                                        className={`px-3 py-2 rounded-lg transition-colors text-sm ${editMode ? 'bg-yellow-600 hover:bg-yellow-700' : 'bg-gray-600 hover:bg-gray-700'} text-white`}
                                        title="Toggle edit mode"
                                    >
                                        {editMode ? '‚úÖ Done' : '‚úèÔ∏è Edit'}
                                    </button>
                                    <label className="px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 text-sm cursor-pointer">
                                        üì• Import
                                        <input type="file" accept=".json" onChange={importData} className="hidden" />
                                    </label>
                                    <button
                                        onClick={exportData}
                                        className="px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 text-sm"
                                        title="Export your data as JSON backup"
                                    >
                                        üì§ Export
                                    </button>
                                </div>
                            </div>
                            
                            {/* Progress Bar */}
                            <div className="mb-4">
                                <div className="flex justify-between text-sm mb-1">
                                    <span className={`font-medium ${darkMode ? 'text-gray-200' : ''}`}>Progress: {stats.tasted} / {stats.total} flavors</span>
                                    <span className="font-bold text-purple-400">{stats.percentage}%</span>
                                </div>
                                <div className="w-full bg-gray-200 rounded-full h-4">
                                    <div 
                                        className="h-4 rounded-full transition-all duration-500"
                                        style={{ 
                                            width: `${stats.percentage}%`,
                                            background: darkMode 
                                                ? 'linear-gradient(to right, #9333ea, #ec4899)'
                                                : 'linear-gradient(to right, #a855f7, #f472b6)'
                                        }}
                                    ></div>
                                </div>
                            </div>

                            {/* Search and Filters */}
                            <div className="flex flex-wrap gap-2 md:gap-3">
                                <div className="flex-1 min-w-48 relative">
                                    <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
                                    <input
                                        type="text"
                                        placeholder="Search flavors..."
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                        className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm md:text-base"
                                    />
                                </div>
                                
                                <select
                                    value={filterCategory}
                                    onChange={(e) => setFilterCategory(e.target.value)}
                                    className={`px-3 md:px-4 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm md:text-base ${darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300'}`}
                                >
                                    {categories.map(cat => (
                                        <option key={cat} value={cat}>{cat}</option>
                                    ))}
                                </select>

                                <select
                                    value={filterStatus}
                                    onChange={(e) => setFilterStatus(e.target.value)}
                                    className={`px-3 md:px-4 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm md:text-base ${darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300'}`}
                                >
                                    <option value="All">All Status</option>
                                    <option value="Tasted">Tasted</option>
                                    <option value="Untasted">Untasted</option>
                                    <option value="Premium">‚ú® Premium</option>
                                    <option value="Limited">‚ö° Limited</option>
                                    <option value="Discontinued">‚ùå Discontinued</option>
                                </select>

                                <button
                                    onClick={() => setShowAddForm(!showAddForm)}
                                    className="px-3 md:px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2 text-sm md:text-base"
                                >
                                    <Plus className="w-5 h-5" />
                                    <span className="hidden sm:inline">Add Custom</span>
                                    <span className="sm:hidden">Add</span>
                                </button>

                                <button
                                    onClick={() => setViewMode(viewMode === 'grid' ? 'tierlist' : 'grid')}
                                    className="px-3 md:px-4 py-2 bg-pink-600 text-white rounded-lg hover:bg-pink-700 transition-colors flex items-center gap-2 text-sm md:text-base"
                                >
                                    {viewMode === 'grid' ? 'üìä Tier List' : 'üé¥ Grid View'}
                                </button>
                            </div>

                            {/* Add Custom Flavor Form */}
                            {showAddForm && (
                                <div className={`mt-4 p-4 rounded-lg ${darkMode ? 'bg-gray-700' : 'bg-gray-50'}`}>
                                    <h3 className={`font-semibold mb-3 text-sm md:text-base ${darkMode ? 'text-white' : ''}`}>Add Custom Flavor</h3>
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                        <input
                                            type="text"
                                            placeholder="Flavor name *"
                                            value={newFlavor.name}
                                            onChange={(e) => setNewFlavor({...newFlavor, name: e.target.value})}
                                            className={`px-4 py-2 border rounded-lg text-sm md:text-base ${darkMode ? 'bg-gray-600 border-gray-500 text-white' : 'border-gray-300'}`}
                                        />
                                        <select
                                            value={newFlavor.category}
                                            onChange={(e) => setNewFlavor({...newFlavor, category: e.target.value})}
                                            className={`px-4 py-2 border rounded-lg text-sm md:text-base ${darkMode ? 'bg-gray-600 border-gray-500 text-white' : 'border-gray-300'}`}
                                        >
                                            <option value="Classic">Classic</option>
                                            <option value="Seasonal">Seasonal</option>
                                            <option value="Regional">Regional</option>
                                            <option value="Fruit">Fruit</option>
                                            <option value="Premium">Premium</option>
                                            <option value="Special">Special</option>
                                            <option value="Other">Other</option>
                                        </select>
                                        <input
                                            type="text"
                                            placeholder="Region"
                                            value={newFlavor.region}
                                            onChange={(e) => setNewFlavor({...newFlavor, region: e.target.value})}
                                            className={`px-4 py-2 border rounded-lg text-sm md:text-base ${darkMode ? 'bg-gray-600 border-gray-500 text-white' : 'border-gray-300'}`}
                                        />
                                        <input
                                            type="text"
                                            placeholder="Country flag emoji (üáØüáµ)"
                                            value={newFlavor.country}
                                            onChange={(e) => setNewFlavor({...newFlavor, country: e.target.value})}
                                            className={`px-4 py-2 border rounded-lg text-sm md:text-base ${darkMode ? 'bg-gray-600 border-gray-500 text-white' : 'border-gray-300'}`}
                                        />
                                        <input
                                            type="number"
                                            placeholder="Year (optional)"
                                            value={newFlavor.year}
                                            onChange={(e) => setNewFlavor({...newFlavor, year: e.target.value})}
                                            className={`px-4 py-2 border rounded-lg text-sm md:text-base ${darkMode ? 'bg-gray-600 border-gray-500 text-white' : 'border-gray-300'}`}
                                        />
                                    </div>
                                    
                                    <div className="flex flex-wrap gap-4 mt-3">
                                        <label className={`flex items-center gap-2 cursor-pointer text-sm ${darkMode ? 'text-white' : ''}`}>
                                            <input
                                                type="checkbox"
                                                checked={newFlavor.premium}
                                                onChange={(e) => setNewFlavor({...newFlavor, premium: e.target.checked})}
                                                className="w-4 h-4"
                                            />
                                            ‚ú® Premium
                                        </label>
                                        <label className={`flex items-center gap-2 cursor-pointer text-sm ${darkMode ? 'text-white' : ''}`}>
                                            <input
                                                type="checkbox"
                                                checked={newFlavor.limited}
                                                onChange={(e) => setNewFlavor({...newFlavor, limited: e.target.checked})}
                                                className="w-4 h-4"
                                            />
                                            ‚ö° Limited
                                        </label>
                                        <label className={`flex items-center gap-2 cursor-pointer text-sm ${darkMode ? 'text-white' : ''}`}>
                                            <input
                                                type="checkbox"
                                                checked={newFlavor.discontinued}
                                                onChange={(e) => setNewFlavor({...newFlavor, discontinued: e.target.checked})}
                                                className="w-4 h-4"
                                            />
                                            ‚ùå Discontinued
                                        </label>
                                    </div>
                                    
                                    <div className="flex gap-2 mt-3">
                                        <button
                                            onClick={addCustomFlavor}
                                            className="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm md:text-base"
                                        >
                                            ‚úÖ Add Flavor
                                        </button>
                                        <button
                                            onClick={() => setShowAddForm(false)}
                                            className="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 text-sm md:text-base"
                                        >
                                            Cancel
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* Tier List View */}
                        {viewMode === 'tierlist' && (
                            <div className="space-y-3">
                                {tierConfig.map(tier => {
                                    const tierFlavors = getTierFlavors(tier.name);
                                    return (
                                        <div key={tier.name} className="flex gap-3">
                                            <div className={`${tier.color} w-16 md:w-20 flex-shrink-0 rounded-lg flex items-center justify-center font-bold text-xl md:text-2xl text-white shadow-lg`}>
                                                {tier.name}
                                            </div>
                                            
                                            <div className={`flex-1 rounded-lg shadow-md p-3 min-h-20 ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                                                {tierFlavors.length === 0 ? (
                                                    <div className={`text-sm italic flex items-center h-full ${darkMode ? 'text-gray-500' : 'text-gray-400'}`}>
                                                        No flavors in {tier.label}
                                                    </div>
                                                ) : (
                                                    <div className="flex flex-wrap gap-2">
                                                        {tierFlavors.map(flavor => {
                                                            let glowClass = 'bg-gradient-to-br from-purple-50 to-pink-50 border border-purple-200';
                                                            
                                                            if (flavor.limited) {
                                                                glowClass = 'bg-gradient-to-r from-purple-100 via-pink-100 to-red-100 border-2 border-pink-400 shadow-lg shadow-pink-300/50';
                                                            } else if (flavor.premium) {
                                                                glowClass = 'bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-yellow-400 shadow-md shadow-yellow-300/50';
                                                            } else if (flavor.category === 'Special') {
                                                                glowClass = 'bg-gradient-to-br from-pink-50 to-purple-50 border border-pink-300 shadow-md shadow-pink-200/50';
                                                            }
                                                            
                                                            return (
                                                                <div
                                                                    key={flavor.id}
                                                                    className={`${glowClass} rounded-lg px-3 py-2 text-sm font-medium text-gray-800 hover:shadow-md transition-all cursor-pointer`}
                                                                    onClick={() => {
                                                                        setViewMode('grid');
                                                                        setTimeout(() => {
                                                                            const element = document.getElementById(`flavor-${flavor.id}`);
                                                                            if (element) {
                                                                                element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                                                                element.classList.add('ring-4', 'ring-yellow-400');
                                                                                setTimeout(() => {
                                                                                    element.classList.remove('ring-4', 'ring-yellow-400');
                                                                                }, 2000);
                                                                            }
                                                                        }, 100);
                                                                    }}
                                                                >
                                                                    <div className="flex items-center gap-1">
                                                                        <div className="font-bold">{flavor.name}</div>
                                                                        {flavor.country && <span className="text-sm">{flavor.country}</span>}
                                                                        {flavor.rating === 5 && <span>üëë</span>}
                                                                    </div>
                                                                    <div className="text-xs text-gray-600 mt-1 flex items-center gap-1">
                                                                        <Star className="w-3 h-3 fill-yellow-400 text-yellow-400" />
                                                                        {flavor.rating.toFixed(1)}
                                                                        {flavor.premium && <span className="ml-1">‚ú®</span>}
                                                                        {flavor.limited && <span className="ml-1">‚ö°</span>}
                                                                        {flavor.discontinued && <span className="ml-1">‚ùå</span>}
                                                                    </div>
                                                                </div>
                                                            );
                                                        })}
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        )}

                        {/* Grid View */}
                        {viewMode === 'grid' && (
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                {filteredFlavors.map(flavor => {
                                    let cardClass = `p-4 transition-all ${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-lg`;
                                    
                                    if (flavor.limited) {
                                        cardClass = `p-4 transition-all ${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-lg shadow-lg shadow-purple-400/50 ring-2 ring-purple-400 hover:shadow-xl`;
                                    } else if (flavor.category === 'Special') {
                                        cardClass = `p-4 transition-all ${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-lg shadow-lg shadow-pink-400/50 ring-2 ring-pink-400 hover:shadow-xl`;
                                    } else if (flavor.category === 'Regional') {
                                        cardClass = `p-4 transition-all ${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-lg shadow-lg shadow-purple-300/50 ring-1 ring-purple-300 hover:shadow-xl`;
                                    } else if (flavor.category === 'Seasonal') {
                                        cardClass = `p-4 transition-all ${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-lg shadow-lg shadow-orange-300/50 ring-1 ring-orange-300 hover:shadow-xl`;
                                    } else if (flavor.discontinued) {
                                        cardClass = `p-4 transition-all ${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-lg shadow-lg shadow-red-400/60 ring-2 ring-red-500 hover:shadow-xl`;
                                    } else {
                                        cardClass = `p-4 transition-all ${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-lg shadow-md hover:shadow-lg`;
                                    }
                                    
                                    if (flavor.tasted) {
                                        cardClass = cardClass.replace(/ring-\w+-\d+/g, 'ring-green-500');
                                        if (!cardClass.includes('ring-')) {
                                            cardClass += ' ring-2 ring-green-500';
                                        }
                                    }
                                    
                                    return (
                                        <div
                                            key={flavor.id}
                                            id={`flavor-${flavor.id}`}
                                            className={cardClass}
                                        >
                                            <div className="flex justify-between items-start mb-3">
                                                <div className="flex-1 min-w-0">
                                                    <div className="flex items-center gap-2 flex-wrap mb-2">
                                                        <h3 className={`font-bold text-base md:text-lg ${darkMode ? 'text-white' : 'text-gray-800'}`}>
                                                            {flavor.name}
                                                        </h3>
                                                        {flavor.year && (
                                                            <span className={`text-sm font-semibold px-2 py-0.5 rounded ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>
                                                                {flavor.year}
                                                            </span>
                                                        )}
                                                        {flavor.country && (
                                                            <span className="text-lg">{flavor.country}</span>
                                                        )}
                                                        {flavor.rating === 5 && (
                                                            <span className="text-lg" title="Perfect 5 stars!">üëë</span>
                                                        )}
                                                    </div>
                                                    <div className="flex flex-wrap gap-2 mt-1">
                                                        {flavor.category !== 'Premium' && (
                                                            <span className={`text-xs px-2 py-1 rounded-full ${
                                                                flavor.category === 'Classic' ? 'bg-blue-100 text-blue-700' :
                                                                flavor.category === 'Seasonal' ? 'bg-orange-100 text-orange-700' :
                                                                flavor.category === 'Regional' ? 'bg-purple-100 text-purple-700' :
                                                                flavor.category === 'Fruit' ? 'bg-green-100 text-green-700' :
                                                                flavor.category === 'Special' ? 'bg-pink-100 text-pink-700' :
                                                                'bg-gray-100 text-gray-700'
                                                            }`}>
                                                                {flavor.category}
                                                            </span>
                                                        )}
                                                        {flavor.limited && (
                                                            <span className="text-xs px-2 py-1 rounded-full bg-gradient-to-r from-purple-500 via-pink-500 to-red-500 text-white font-bold shadow-lg">
                                                                ‚ö° LIMITED
                                                            </span>
                                                        )}
                                                        {flavor.premium && (
                                                            <span className="text-xs px-2 py-1 rounded-full bg-gradient-to-r from-yellow-400 to-orange-400 text-white font-bold shadow-md">
                                                                ‚ú® LUXURIOUS
                                                            </span>
                                                        )}
                                                        {flavor.discontinued && (
                                                            <span className="text-xs px-2 py-1 rounded-full bg-red-600 text-white font-bold">
                                                                ‚ùå DISCONTINUED
                                                            </span>
                                                        )}
                                                    </div>
                                                </div>
                                                
                                                <div className="flex gap-2 ml-2 flex-shrink-0">
                                                    <button
                                                        onClick={() => toggleTasted(flavor.id)}
                                                        className={`p-2 rounded-full transition-all shadow-lg ${
                                                            flavor.tasted 
                                                                ? 'bg-green-500 text-white ring-4 ring-green-300' 
                                                                : 'bg-gray-200 text-gray-400 hover:bg-gray-300'
                                                        }`}
                                                    >
                                                        <Check className="w-4 h-4 md:w-5 md:h-5 stroke-[3]" />
                                                    </button>
                                                </div>
                                            </div>

                                            {/* Rating */}
                                            <div className="flex items-center gap-1 mb-3">
                                                {[1, 2, 3, 4, 5].map(starNum => (
                                                    <div key={starNum} className="relative inline-flex">
                                                        <button
                                                            onClick={() => {
                                                                const newRating = flavor.rating === starNum - 0.5 ? 0 : starNum - 0.5;
                                                                updateRating(flavor.id, newRating);
                                                            }}
                                                            className="absolute left-0 w-1/2 h-full z-10 cursor-pointer"
                                                            style={{ background: 'transparent' }}
                                                        />
                                                        <button
                                                            onClick={() => {
                                                                const newRating = flavor.rating === starNum ? 0 : starNum;
                                                                updateRating(flavor.id, newRating);
                                                            }}
                                                            className="absolute right-0 w-1/2 h-full z-10 cursor-pointer"
                                                            style={{ background: 'transparent' }}
                                                        />
                                                        <div className="relative pointer-events-none">
                                                            <Star className="w-5 h-5 text-gray-300" />
                                                            {flavor.rating > 0 && flavor.rating >= starNum - 0.5 && (
                                                                <div 
                                                                    className="absolute top-0 left-0 overflow-hidden"
                                                                    style={{ 
                                                                        width: flavor.rating >= starNum ? '100%' : '50%'
                                                                    }}
                                                                >
                                                                    <Star className="w-5 h-5 fill-yellow-400 text-yellow-400" />
                                                                </div>
                                                            )}
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>

                                            {/* Notes and Controls */}
                                            <div className="space-y-2">
                                                {editMode && editingFlavorId === flavor.id ? (
                                                    <div className={`p-3 rounded-lg ${darkMode ? 'bg-gray-700' : 'bg-gray-100'}`}>
                                                        <input
                                                            type="text"
                                                            value={flavor.name}
                                                            onChange={(e) => updateFlavor(flavor.id, { name: e.target.value })}
                                                            className={`w-full px-2 py-1 mb-2 rounded text-sm ${darkMode ? 'bg-gray-600 text-white' : ''}`}
                                                            placeholder="Name"
                                                        />
                                                        <div className="flex gap-2 mb-2 flex-wrap">
                                                            <input
                                                                type="text"
                                                                value={flavor.country || ''}
                                                                onChange={(e) => updateFlavor(flavor.id, { country: e.target.value })}
                                                                className={`px-2 py-1 rounded text-sm w-16 ${darkMode ? 'bg-gray-600 text-white' : ''}`}
                                                                placeholder="üáØüáµ"
                                                            />
                                                            <input
                                                                type="number"
                                                                value={flavor.year || ''}
                                                                onChange={(e) => updateFlavor(flavor.id, { year: e.target.value ? parseInt(e.target.value) : undefined })}
                                                                className={`px-2 py-1 rounded text-sm w-20 ${darkMode ? 'bg-gray-600 text-white' : ''}`}
                                                                placeholder="Year"
                                                            />
                                                        </div>
                                                        <div className="flex gap-2 flex-wrap text-xs mb-2">
                                                            <label className={darkMode ? 'text-white' : ''}>
                                                                <input type="checkbox" checked={flavor.premium || false} onChange={(e) => updateFlavor(flavor.id, { premium: e.target.checked })} /> ‚ú®Luxurious
                                                            </label>
                                                            <label className={darkMode ? 'text-white' : ''}>
                                                                <input type="checkbox" checked={flavor.limited || false} onChange={(e) => updateFlavor(flavor.id, { limited: e.target.checked })} /> ‚ö°Limited
                                                            </label>
                                                            <label className={darkMode ? 'text-white' : ''}>
                                                                <input type="checkbox" checked={flavor.discontinued || false} onChange={(e) => updateFlavor(flavor.id, { discontinued: e.target.checked })} /> ‚ùåDiscontinued
                                                            </label>
                                                        </div>
                                                        <div className="flex gap-2">
                                                            <button onClick={() => setEditingFlavorId(null)} className="px-3 py-1 bg-green-600 text-white rounded text-sm">‚úÖ Done</button>
                                                            <button onClick={() => deleteFlavor(flavor.id)} className="px-3 py-1 bg-red-600 text-white rounded text-sm">üóëÔ∏è Delete</button>
                                                        </div>
                                                    </div>
                                                ) : (
                                                    <>
                                                        <button
                                                            onClick={() => toggleNotes(flavor.id)}
                                                            className={`text-sm ${darkMode ? 'text-gray-400 hover:text-gray-200' : 'text-gray-500 hover:text-gray-700'} flex items-center gap-1 font-medium`}
                                                        >
                                                            {expandedNotes[flavor.id] ? 'üìù Hide Notes' : 'üìù Notes'}
                                                        </button>
                                                        
                                                        {expandedNotes[flavor.id] && (
                                                            <textarea
                                                                placeholder="Add Notes"
                                                                value={flavor.notes}
                                                                onChange={(e) => updateNotes(flavor.id, e.target.value)}
                                                                className={`w-full px-3 py-2 text-xs md:text-sm border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white placeholder-gray-400' : 'border-gray-300'}`}
                                                                rows="2"
                                                            />
                                                        )}
                                                        
                                                        {editMode && (
                                                            <button
                                                                onClick={() => setEditingFlavorId(flavor.id)}
                                                                className="w-full px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-xs md:text-sm font-medium transition-colors"
                                                            >
                                                                ‚úèÔ∏è Edit Flavor
                                                            </button>
                                                        )}
                                                    </>
                                                )}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        )}

                        {viewMode === 'grid' && filteredFlavors.length === 0 && (
                            <div className={`text-center py-12 ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>
                                No flavors found matching your filters.
                            </div>
                        )}

                        {/* Info Footer */}
                        <div className={`mt-6 p-4 rounded-lg shadow-md text-sm ${darkMode ? 'bg-gray-800 text-gray-300' : 'bg-white text-gray-600'}`}>
                            <p className="mb-2"><strong>üì± Using on iOS/Phone:</strong> Open this page in Safari, tap Share ‚Üí "Add to Home Screen" to use as an app!</p>
                            <p className="mb-2"><strong>üíæ Data Storage:</strong> Your progress saves automatically to your browser. Use Export to backup, Import to restore.</p>
                            <p><strong>üé® Features:</strong> Dark mode, tier list view, premium/limited/discontinued tags, country flags, and full editing control!</p>
                        </div>
                    </div>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<PockyTracker />, document.getElementById('root'));
    </script>
</body>
</html>